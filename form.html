<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Sign Up | Log In</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <div class="wrapper">
       <div class="title-text">
          <div class="title login">
             Login
          </div>
          <div class="title signup">
             Sign Up
          </div>
       </div>
       <div class="form-container">
          <div class="slide-controls">
             <input type="radio" name="slide" id="login" checked>
             <input type="radio" name="slide" id="signup">
             <label for="login" class="slide login">Login</label>
             <label for="signup" class="slide signup">SignUp</label>
             <div class="slider-tab"></div>
          </div>
          <div class="form-inner">
             <!-- Login Form -->
             <form id="loginForm" class="login">
                <div class="field">
                   <input type="email" name="email" placeholder="Email Address" required>
                </div>
                <div class="field">
                   <input type="password" name="password" placeholder="Password" required>
                </div>
                <div class="pass-link">
                   <a href="#">Reset password?</a>
                </div>
                <div class="field btn">
                   <div class="btn-layer"></div>
                   <input type="submit" value="Login">
                </div>
                <div class="signup-link">
                   Don't have an account? <a href="#">Create a new account</a>
                </div>
             </form>
             <div id="loginMessage"></div> <!-- Message Display -->

             <!-- Sign Up Form -->
             <form id="signupForm" action="http://localhost:5000/signup" method="POST" class="signup">
                <div class="field">
                   <input type="email" name="email" placeholder="Email Address" required>
                </div>
                <div class="field">
                   <input type="password" name="password" placeholder="Password" required>
                </div>
                <div class="field">
                   <input type="password" name="confirmPassword" placeholder="Confirm Password" required>
                </div>
                <div class="field btn">
                   <div class="btn-layer"></div>
                   <input type="submit" value="SignUp">
                </div>
                <div class="signup-link">
                   Already have an account? <a href="#">Login here</a>
                </div>
             </form>
          </div>
       </div>
    </div>

    <script src="style.js"></script>
    <script>
      // Login and SignUp Toggle Handling
      document.getElementById("login").addEventListener("click", () => {
        document.querySelector(".login").style.display = "block";
        document.querySelector(".signup").style.display = "none";
      });
      document.getElementById("signup").addEventListener("click", () => {
        document.querySelector(".signup").style.display = "block";
        document.querySelector(".login").style.display = "none";
      });
    
      // Handling SignUp Form Submission
      document.getElementById("signupForm").addEventListener("submit", async (e) => {
        e.preventDefault(); // Prevent default form submission
    
        const email = document.querySelector('#signupForm input[name="email"]').value.trim();
        const password = document.querySelector('#signupForm input[name="password"]').value.trim();
        const confirmPassword = document.querySelector('#signupForm input[name="confirmPassword"]').value.trim();
    
        // Ensure both passwords match
        if (password !== confirmPassword) {
          alert("Passwords do not match!");
          return;
        }
    
        const response = await fetch('http://localhost:5000/signup', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, password })
        });
    
        const result = await response.json();
    
        if (response.ok) {
          alert(result.message);
          localStorage.setItem("userId", result.userId);  // Store userId in localStorage
          window.location.href = "input.html";  // Redirect to input.html after successful signup
        } else {
          alert("Error: " + result.error);
        }
      });
    
      // Handling Login Form Submission
      document.getElementById("loginForm").addEventListener("submit", async (e) => {
        e.preventDefault(); // Prevent default form submission
    
        const email = document.querySelector('#loginForm input[name="email"]').value.trim();
        const password = document.querySelector('#loginForm input[name="password"]').value.trim();
    
        const response = await fetch('http://localhost:5000/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, password })
        });
    
        const result = await response.json();
        const loginMessage = document.getElementById("loginMessage");
    
        if (response.ok) {
          loginMessage.textContent = "Login Successful!";
          loginMessage.style.color = "green";
          localStorage.setItem("userId", result.userId);  // Store userId in localStorage
          window.location.href = "input.html";  // Redirect to input.html after successful login
        } else {
          loginMessage.textContent = "Login failed: " + result.error;
          loginMessage.style.color = "red";
        }
      });
    </script>
    
    
  </body>
</html>
